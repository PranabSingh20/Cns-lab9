#include <bits/stdc++.h>
#include <gmpxx.h>
#include <gmp.h>
using namespace std;

int main()
{
    mpz_class prime;
    mpz_class base = 2;
    mpz_class secret_alice, secret_bob, calc_alice, calc_bob;

    prime = "12745216229761186769575009943944198619149164746831579719941140425076456621824834322853258804883232842877311723249782818608677050956745409379781245497526069657222703636504651898833151008222772087491045206203033063108075098874712912417029101508315117935752962862335062591404043092163187352352197487303798807791605274487594646923";
    secret_alice = "54645216229761186769575009943944198619149164746831579719941140425076456621824834322853258804883232842877311723249782818608677050956745409379781245497526069657222703636504651898833151008222772087491045206203033063108075098874712912417029101508315117935752962862335062591404043092163187352352197487303798807791605274487594646920";
    secret_bob = "23145216229761186769575009943944198619149164746831579719941140425076456621824834322853258804883232842877311723249782818608677050956745409379781245497526069657222703636504651898833151008222772087491045206203033063108075098874712912417029101508315117935752962862335062591404043092163187352352197487303798807791605274487594646924 ";

    mpz_class tmp = calc_alice;

    mpz_powm(calc_alice.get_mpz_t(), calc_bob.get_mpz_t(), secret_alice.get_mpz_t(), prime.get_mpz_t());
    mpz_powm(calc_bob.get_mpz_t(), tmp.get_mpz_t(), secret_bob.get_mpz_t(), prime.get_mpz_t());
    cout << "Public key received by Bob : " << calc_alice << endl;
    cout << "Public key received by Alice : " << calc_bob << endl;

    mpz_powm(calc_alice.get_mpz_t(), calc_bob.get_mpz_t(), secret_alice.get_mpz_t(), prime.get_mpz_t());
    mpz_powm(calc_bob.get_mpz_t(), calc_alice.get_mpz_t(), secret_bob.get_mpz_t(), prime.get_mpz_t());

    cout << "Secret key for Alice : " << calc_alice << endl;
    cout << "Secret key for Bob : " << calc_bob << endl;

    return 0;
}